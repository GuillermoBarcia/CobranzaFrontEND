<div class="main-container-bg mx-auto px-4 py-6 w-full">
  <lib-bread-crumb
    [titulo]="'Registro de Préstamo Maestro'"
    [items]="[
      { label: 'Cobranza', url: '/' },
      { label: 'Préstamo Maestro', url: '' },
      { label: 'Registro de Préstamo Maestro' }
    ]"
  ></lib-bread-crumb>

  <div class="p-4 space-y-6">
    <div class="flex justify-start mt-4">
      <lib-search (search)="onSearch()">
        <form [formGroup]="searchForm">
          <mat-form-field appearance="fill">
            <mat-label>Pagaré</mat-label>
            <input matInput type="text" formControlName="p">
          </mat-form-field>
        </form>
        <button type="submit" style="display: none"></button>
      </lib-search>
    </div>

    <form [formGroup]="prestamoForm" class="bg-white rounded-xl shadow-md p-6 grid grid-cols-1 md:grid-cols-2 gap-4">
      <mat-form-field appearance="fill">
        <mat-label>Número Pagaré</mat-label>
        <input matInput type="text" formControlName="numeroPagare" readonly>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Identificación Cliente Externo</mat-label>
        <input matInput type="number" formControlName="identificaClienteExterno" readonly>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Identificación</mat-label>
        <input matInput type="text" formControlName="identificacion" readonly>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Nombre</mat-label>
        <input matInput type="text" formControlName="nombre" readonly>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Apellido</mat-label>
        <input matInput type="text" formControlName="apellido" readonly>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Monto Aprobado</mat-label>
        <input matInput type="number" formControlName="montoAprobado" readonly>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Monto Desembolsado</mat-label>
        <input matInput type="number" formControlName="montoDesembolsado" readonly>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Fecha Adjudicación</mat-label>
        <input matInput [matDatepicker]="picker1" formControlName="fechaAdjudicacion" readonly>
        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
        <mat-datepicker #picker1></mat-datepicker>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Fecha Vencimiento</mat-label>
        <input matInput [matDatepicker]="picker2" formControlName="fechaVencimiento" readonly>
        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
        <mat-datepicker #picker2></mat-datepicker>
      </mat-form-field>

      <!-- <mat-form-field appearance="fill">
        <mat-label>Secuencial Oficina</mat-label>
        <input matInput type="number" formControlName="secuencialOficina">
      </mat-form-field> -->

        <mat-form-field appearance="fill">
        <mat-label>Nombre de Oficina</mat-label>
        <input matInput type="text" [value]="oficinaNombre || ''" readonly>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Código Usuario</mat-label>
        <input matInput type="text" formControlName="codigoUsuario" readonly>
      </mat-form-field>

      <!-- Componente para subir documentos -->
      <div class="col-span-2">
        <app-prestamo-maestro (documentoUploaded)="onDocumentoUploaded($event)"></app-prestamo-maestro>
        <p class="text-sm text-red-600 mt-2" *ngIf="!informeDocumento || !actaDocumento">
          Debe subir ambos documentos (Informe y Acta) para guardar.
        </p>
      </div>

      <div class="flex justify-end col-span-2">
        <button mat-button color="warn" [routerLink]="['/cobranzas']">Cancelar</button>
        <button mat-flat-button color="primary" (click)="onSubmit()" [disabled]="!prestamoForm.valid || !informeDocumento || !actaDocumento">Guardar</button>
      </div>
    </form>
  </div>
</div>